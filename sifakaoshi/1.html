<html>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
 var getElementXPath = function(element) {
      if (element && element.id)
          return '//*[@id="' + element.id + '"]';
      else
          return getElementTreeXPath(element);
  };

  var getElementTreeXPath = function(element) {
      var paths = [];

      // Use nodeName (instead of localName) so namespace prefix is included (if any).
      for (; element && element.nodeType == 1; element = element.parentNode)  {
          var index = 0;
          // EXTRA TEST FOR ELEMENT.ID
          if (element && element.id) {
              paths.splice(0, 0, '/*[@id="' + element.id + '"]');
              break;
          }

          for (var sibling = element.previousSibling; sibling; sibling = sibling.previousSibling) {
              // Ignore document type declaration.
              if (sibling.nodeType == Node.DOCUMENT_TYPE_NODE)
                continue;

              if (sibling.nodeName == element.nodeName)
                  ++index;
          }

          var tagName = element.nodeName.toLowerCase();
          var pathIndex = (index ? "[" + (index+1) + "]" : "");
          paths.splice(0, 0, tagName + pathIndex);
      }

      return paths.length ? "/" + paths.join("/") : null;
  };

function getSelectedWords(){
	if (window.getSelection){
		return window.getSelection();
	} else if (document.getSelection){
		return document.getSelection();
	} else if (document.selection){
		return document.selection.createRange().text;
	} else return;
}  
</script>


<style type="text/css">

.popup-tag{
	position:absolute;
	display: block;
	background-color:#785448d4;
	color: #9E9E9E;
	padding:10px;
	font-size:20px;
	font-weight:bold;
	text-decoration:underline;
	cursor:pointer;
	/* 	-webkit-filter: drop-shadow(0 1px 10px rgba(113,158,206,0.8));} */
</style>


<body>



<div id="content" onmouseup=highlightSelection()>
<span class="popup-tag"></span>

# Intro
Go ahead, play around with the editor! Be sur
e to check out **bold** and *italic* styling, or even [links](https://google.com). You can type the Markdown syntax,
 use the toolbar, or use shortcuts like `cmd-b` or `ctrl-b`.

 - https://marked.js.org/#/USING_PRO.md#tokenizer
 - https://github.com/evilstreak/markdown-js

</div>


<script type="text/javascript">

document.write("hello")

// var simplemde = new SimpleMDE({
// 	element: document.getElementById("demo1"),
// });



function highlightSelection() {
    var selection = getSelectedWords();
    
    if(selection != ''){
//     	alert(selection)
    	var el = document.getElementsByClassName("popup-tag")[0];
    	el.style.display = "block";
    	el.style.top = event.clientY;
    	el.style.left = event.clientX;
	    el.textContent = selection;
	    alert(getElementXPath(selection))
        }else{
            document.getElementsByClassName("popup-tag")[0].style.display="none";
     }
//     if (userSelection != "" ){
// 		for(var i = 0; i < userSelection.rangeCount; i++) {
// 			highlightRange(userSelection.getRangeAt(i));
// 		}
//     }

}

function highlightRange(range) {
    var newNode = document.createElement("span");
    newNode.setAttribute(
       "style",
       "background-color: yellow; display: inline;"
    );
    range.surroundContents(newNode);
}
 
document.getElementById('content').innerHTML = marked(document.getElementById("content").innerHTML);


</script>
</body>
